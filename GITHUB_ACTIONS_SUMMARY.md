# ğŸš€ GitHub Actions è‡ªåŠ¨åŒ–æ„å»ºæ€»ç»“

## ğŸ“‹ å·²é…ç½®çš„è‡ªåŠ¨åŒ–æµç¨‹

æˆ‘å·²ç»ä¸º New API é¡¹ç›®é…ç½®äº†å®Œæ•´çš„ GitHub Actions è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹ï¼ŒåŒ…æ‹¬ï¼š

### ğŸ”„ å·¥ä½œæµåˆ—è¡¨

| å·¥ä½œæµ | æ–‡ä»¶ | è§¦å‘æ¡ä»¶ | åŠŸèƒ½ |
|--------|------|----------|------|
| **CI æµ‹è¯•** | `ci.yml` | Push/PR | ä»£ç æµ‹è¯•ã€è´¨é‡æ£€æŸ¥ã€å®‰å…¨æ‰«æ |
| **Docker æ„å»º** | `docker-build.yml` | Push/PR/Tag | å¤šæ¶æ„ Docker é•œåƒæ„å»º |
| **å¯æ‰§è¡Œæ–‡ä»¶æ„å»º** | `build-release.yml` | Push/Tag | å¤šå¹³å°äºŒè¿›åˆ¶æ–‡ä»¶æ„å»º |
| **è‡ªåŠ¨å‘å¸ƒ** | `auto-release.yml` | Tag æ¨é€ | è‡ªåŠ¨åˆ›å»º GitHub Release |
| **ä¾èµ–æ›´æ–°** | `dependabot.yml` | å®šæ—¶ | è‡ªåŠ¨ä¾èµ–æ›´æ–°ç®¡ç† |

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. ğŸ§ª CI/CD æµæ°´çº¿
```
ä»£ç æ¨é€ â†’ æµ‹è¯• â†’ æ„å»º â†’ å®‰å…¨æ‰«æ â†’ å‘å¸ƒ
```

### 2. ğŸ³ Docker è‡ªåŠ¨æ„å»º
- **ä¸»åº”ç”¨é•œåƒ**: `ghcr.io/lim12137/new-api`
- **TEI æœåŠ¡é•œåƒ**: `ghcr.io/lim12137/new-api-tei`
- **TEI é¢„åŠ è½½é•œåƒ**: `ghcr.io/lim12137/new-api-tei-preload`

### 3. ğŸ“¦ å¤šå¹³å°äºŒè¿›åˆ¶æ„å»º
- Windows (amd64, arm64)
- Linux (amd64, arm64, 386)
- macOS (amd64, arm64)

### 4. ğŸ”’ å®‰å…¨å’Œè´¨é‡ä¿è¯
- ä»£ç è´¨é‡æ£€æŸ¥ (golangci-lint)
- å®‰å…¨æ¼æ´æ‰«æ (Gosec, Trivy)
- ä¾èµ–å®‰å…¨æ›´æ–° (Dependabot)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¼€å‘æµç¨‹
```bash
# 1. å¼€å‘åŠŸèƒ½
git checkout -b feature/new-feature
# ... å¼€å‘ä»£ç  ...

# 2. æ¨é€ä»£ç  (è§¦å‘ CI)
git push origin feature/new-feature

# 3. åˆ›å»º PR (è§¦å‘å®Œæ•´æµ‹è¯•)
# åœ¨ GitHub ä¸Šåˆ›å»º Pull Request

# 4. åˆå¹¶åˆ°ä¸»åˆ†æ”¯ (è§¦å‘æ„å»º)
git checkout main
git merge feature/new-feature
git push origin main
```

### å‘å¸ƒæµç¨‹
```bash
# 1. åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag v1.6.0
git push origin v1.6.0

# 2. è‡ªåŠ¨è§¦å‘ï¼š
# - Docker é•œåƒæ„å»ºå’Œæ¨é€
# - å¤šå¹³å°äºŒè¿›åˆ¶æ–‡ä»¶æ„å»º
# - GitHub Release åˆ›å»º
# - å˜æ›´æ—¥å¿—ç”Ÿæˆ
```

## ğŸ“Š æ„å»ºäº§ç‰©

### Docker é•œåƒ
```bash
# æ‹‰å–æœ€æ–°é•œåƒ
docker pull ghcr.io/lim12137/new-api:latest
docker pull ghcr.io/lim12137/new-api-tei:latest

# ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬
docker pull ghcr.io/lim12137/new-api:v1.6.0
docker pull ghcr.io/lim12137/new-api-tei:v1.6.0
```

### äºŒè¿›åˆ¶æ–‡ä»¶
```bash
# ä¸‹è½½ Linux ç‰ˆæœ¬
wget https://github.com/lim12137/new-api/releases/download/v1.6.0/new-api-linux-amd64.tar.gz

# ä¸‹è½½ Windows ç‰ˆæœ¬
wget https://github.com/lim12137/new-api/releases/download/v1.6.0/new-api-windows-amd64.zip

# ä¸‹è½½ macOS ç‰ˆæœ¬
wget https://github.com/lim12137/new-api/releases/download/v1.6.0/new-api-darwin-amd64.tar.gz
```

## ğŸ”§ é…ç½®è¦ç‚¹

### 1. ç¯å¢ƒå˜é‡
- `GITHUB_TOKEN`: è‡ªåŠ¨é…ç½®ï¼Œç”¨äºæ¨é€é•œåƒå’Œåˆ›å»ºå‘å¸ƒ
- `HF_ENDPOINT`: å¯é€‰ï¼ŒHuggingFace é•œåƒç«¯ç‚¹

### 2. æƒé™è®¾ç½®
- `contents: read` - è¯»å–ä»£ç 
- `packages: write` - æ¨é€ Docker é•œåƒ
- `security-events: write` - ä¸Šä¼ å®‰å…¨æ‰«æç»“æœ

### 3. åˆ†æ”¯ä¿æŠ¤
å»ºè®®ä¸º `main` åˆ†æ”¯å¯ç”¨ä¿æŠ¤è§„åˆ™ï¼Œè¦æ±‚é€šè¿‡æ‰€æœ‰æ£€æŸ¥æ‰èƒ½åˆå¹¶ã€‚

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### æ„å»ºçŠ¶æ€
å¯ä»¥åœ¨ GitHub ä»“åº“çš„ Actions é¡µé¢æŸ¥çœ‹ï¼š
- æ„å»ºå†å²å’ŒçŠ¶æ€
- è¯¦ç»†çš„æ„å»ºæ—¥å¿—
- å¤±è´¥åŸå› åˆ†æ

### è‡ªåŠ¨æ›´æ–°
Dependabot ä¼šè‡ªåŠ¨ï¼š
- æ£€æŸ¥ä¾èµ–æ›´æ–°
- åˆ›å»ºæ›´æ–° PR
- è¿è¡Œæµ‹è¯•éªŒè¯

### å®‰å…¨æ‰«æ
å®šæœŸè¿›è¡Œï¼š
- ä»£ç å®‰å…¨æ‰«æ
- å®¹å™¨æ¼æ´æ‰«æ
- ä¾èµ–å®‰å…¨æ£€æŸ¥

## ğŸ¯ ä¼˜åŠ¿ç‰¹ç‚¹

### 1. ğŸ”„ å®Œå…¨è‡ªåŠ¨åŒ–
- æ— éœ€æ‰‹åŠ¨æ„å»ºå’Œå‘å¸ƒ
- è‡ªåŠ¨åŒ–æµ‹è¯•å’Œè´¨é‡æ£€æŸ¥
- è‡ªåŠ¨åŒ–å®‰å…¨æ‰«æ

### 2. ğŸŒ å¤šå¹³å°æ”¯æŒ
- æ”¯æŒ 7 ç§å¹³å°æ¶æ„ç»„åˆ
- Docker å¤šæ¶æ„é•œåƒ
- äº¤å‰ç¼–è¯‘ä¼˜åŒ–

### 3. ğŸ›¡ï¸ å®‰å…¨å¯é 
- å¤šå±‚å®‰å…¨æ‰«æ
- è‡ªåŠ¨ä¾èµ–æ›´æ–°
- ç­¾åå’ŒéªŒè¯

### 4. ğŸ“Š å¯è§‚æµ‹æ€§
- è¯¦ç»†çš„æ„å»ºæ—¥å¿—
- çŠ¶æ€å¾½ç« æ˜¾ç¤º
- å¤±è´¥é€šçŸ¥æœºåˆ¶

## ğŸ”® æœªæ¥æ‰©å±•

### è®¡åˆ’æ”¹è¿›
- [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•
- [ ] é›†æˆä»£ç è¦†ç›–ç‡æŠ¥å‘Š
- [ ] æ·»åŠ è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
- [ ] é›†æˆæ›´å¤šå®‰å…¨æ‰«æå·¥å…·

### å¯é€‰å¢å¼º
- [ ] æ·»åŠ  Slack/Discord é€šçŸ¥
- [ ] é›†æˆ SonarQube ä»£ç è´¨é‡åˆ†æ
- [ ] æ·»åŠ è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆ
- [ ] é›†æˆå®¹å™¨é•œåƒç­¾å

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ğŸ“– [è¯¦ç»†ä½¿ç”¨æŒ‡å—](docs/GITHUB_ACTIONS.md)
- ğŸ³ [Docker éƒ¨ç½²æŒ‡å—](docs/DEPLOYMENT_GUIDE.md)
- ğŸ”§ [å¼€å‘è€…æŒ‡å—](docs/DEVELOPMENT.md)
- ğŸ›¡ï¸ [å®‰å…¨æŒ‡å—](docs/SECURITY.md)

---

**ğŸ‰ GitHub Actions è‡ªåŠ¨åŒ–æ„å»ºå·²å®Œå…¨é…ç½®ï¼Œæ”¯æŒä¸€é”®å‘å¸ƒå’Œå¤šå¹³å°æ„å»ºï¼**

### ç«‹å³ä½“éªŒ
1. æ¨é€ä»£ç åˆ° `rerank` åˆ†æ”¯æŸ¥çœ‹ CI æµç¨‹
2. åˆ›å»ºæ ‡ç­¾ `v1.6.0` è§¦å‘å®Œæ•´å‘å¸ƒæµç¨‹
3. åœ¨ GitHub Packages æŸ¥çœ‹è‡ªåŠ¨æ„å»ºçš„ Docker é•œåƒ

**æ ¸å¿ƒä»·å€¼**: å¼€å‘è€…ä¸“æ³¨ä»£ç ï¼Œæ„å»ºå‘å¸ƒå…¨è‡ªåŠ¨ï¼ ğŸš€
